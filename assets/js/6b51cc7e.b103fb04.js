"use strict";(self.webpackChunkKarmaCoin=self.webpackChunkKarmaCoin||[]).push([[7337],{3905:(e,r,i)=>{i.d(r,{Zo:()=>d,kt:()=>m});var t=i(7294);function n(e,r,i){return r in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i,e}function a(e,r){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),i.push.apply(i,t)}return i}function o(e){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?a(Object(i),!0).forEach((function(r){n(e,r,i[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))}))}return e}function s(e,r){if(null==e)return{};var i,t,n=function(e,r){if(null==e)return{};var i,t,n={},a=Object.keys(e);for(t=0;t<a.length;t++)i=a[t],r.indexOf(i)>=0||(n[i]=e[i]);return n}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)i=a[t],r.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var l=t.createContext({}),c=function(e){var r=t.useContext(l),i=r;return e&&(i="function"==typeof e?e(r):o(o({},r),e)),i},d=function(e){var r=c(e.components);return t.createElement(l.Provider,{value:r},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},f=t.forwardRef((function(e,r){var i=e.components,n=e.mdxType,a=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=c(i),f=n,m=p["".concat(l,".").concat(f)]||p[f]||u[f]||a;return i?t.createElement(m,o(o({ref:r},d),{},{components:i})):t.createElement(m,o({ref:r},d))}));function m(e,r){var i=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var a=i.length,o=new Array(a);o[0]=f;var s={};for(var l in r)hasOwnProperty.call(r,l)&&(s[l]=r[l]);s.originalType=e,s[p]="string"==typeof e?e:n,o[1]=s;for(var c=2;c<a;c++)o[c]=i[c];return t.createElement.apply(null,o)}return t.createElement.apply(null,i)}f.displayName="MDXCreateElement"},8498:(e,r,i)=>{i.r(r),i.d(r,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var t=i(7462),n=(i(7294),i(3905));const a={id:"verifiers",title:"Verifiers",sidebar_label:"Verifiers",slug:"/verifiers"},o=void 0,s={unversionedId:"design/verifiers",id:"version-0.1.0/design/verifiers",title:"Verifiers",description:"About Verifiers",source:"@site/versioned_docs/version-0.1.0/design/verifiers.md",sourceDirName:"design",slug:"/verifiers",permalink:"/docs/verifiers",draft:!1,editUrl:"https://github.com/avive/karmacoin-docs/versioned_docs/version-0.1.0/design/verifiers.md",tags:[],version:"0.1.0",lastUpdatedBy:"avive",lastUpdatedAt:1677088798,formattedLastUpdatedAt:"Feb 22, 2023",frontMatter:{id:"verifiers",title:"Verifiers",sidebar_label:"Verifiers",slug:"/verifiers"},sidebar:"version-0.1.0/someSidebar",previous:{title:"Onboarding",permalink:"/docs/onboarding"},next:{title:"Mobile App",permalink:"/docs/mobile-app"}},l={},c=[{value:"About Verifiers",id:"about-verifiers",level:2},{value:"Verifier Role",id:"verifier-role",level:2},{value:"Signups and Referral Rewards Flow Role",id:"signups-and-referral-rewards-flow-role",level:2},{value:"Current Implementation",id:"current-implementation",level:2},{value:"Implementation Notes",id:"implementation-notes",level:3}],d={toc:c},p="wrapper";function u(e){let{components:r,...i}=e;return(0,n.kt)(p,(0,t.Z)({},d,i,{components:r,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"about-verifiers"},"About Verifiers"),(0,n.kt)("p",null,"Users in Karma Coin are identified by their mobile phone numbers. We employ this design to mitigate creation of multiple accounts by users as Karma Coin is designed for people and each user should only have one Karma Coin account."),(0,n.kt)("p",null,"Verifiers are microservices that are responsible for verifying users mobile phone numbers. Currently, verifiers are centrally trusted. We plan to decentralize them in future releases of Karma Coin software. The identity of verifiers is part of a Karma Coin blockchain genesis config. This identity is a public key of a verifier key pair used to sign verification messages."),(0,n.kt)("h2",{id:"verifier-role"},"Verifier Role"),(0,n.kt)("p",null,"Verifiers get requests from users client app to verify a phone number. Verification is an association between a user's accountId (its public key) and a mobile phone number. A verifier verifies the association and returns a signed message signed with the verifier private identity key. This message is included by user's clients in NewUserV1 signup transactions. Block producers validate that this message was signed by a trusted verifier before creating a new on-chain user account when processing the new user transaction. This design makes the verification evidence part of the core transaction processing logic and makes it unnecessary for block producers to use an external api service when processing transactions. In addition, the verifier evidence goes on-chain and therefore is agreed upon as valid by the Karma Coin blockchain validators. Their honest behavior is to only approve signup transactions in blocks that use a trusted validators and are properly signed by such validator."),(0,n.kt)("h2",{id:"signups-and-referral-rewards-flow-role"},"Signups and Referral Rewards Flow Role"),(0,n.kt)("p",null,"In addition to phone verification role, validators store the ids of payment transactions to non-users and add these ids in the attestations they provide to users as part of the signup flow. For more information see ",(0,n.kt)("a",{parentName:"p",href:"/docs/onboarding"},"onboarding"),".\nVerifier has access to a backing Karmachain node. The node should expose an RPC to get the transactions in the pool. Verifier is using this RPC to query the pool for payment and new user transactions to fulfill its signup and the referral rewards role."),(0,n.kt)("p",null,"For signups with a referral flow, the verifier is responsible for sending a text message to a payment transaction receiver's phone number when there's no on-chain account already for this receiver. The text message includes information about the appreciation and/or payment and instructions how to download the Karma Coin app to the user's device."),(0,n.kt)("p",null,"For referral rewards, the verifier is responsible for including in attestations provided to users as part of the sign-up flow with the transaction id of the referral transaction if such is available in the pool."),(0,n.kt)("h2",{id:"current-implementation"},"Current Implementation"),(0,n.kt)("p",null,"User clients use Firebase phone authentication to sign up to Karma Coin. We store the user's account ID in the Firebase users database using the user's name field. Verifiers use the firebase admin api to query the firebase users database and to check that the user is indeed authenticated on Firebase using his requested mobile phone number and account id. This logic is implemented ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/karma-coin/karmacoin-verifier"},"here"),"."),(0,n.kt)("p",null,"The full verification flow is implemented by the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/karma-coin/karmacoin-app"},"Karma Coin client app")," and by the Karma Coin server transaction processing logic and verifier API implementation."),(0,n.kt)("h3",{id:"implementation-notes"},"Implementation Notes"),(0,n.kt)("p",null,"The verifier is implemented in Dart because the Firebase admin sdk is not yet available for Rust. The Dart implementation is used by the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/karma-coin/karmacoin-server"},"Rust Karma coin server")," as an implementation details and users use the verifier API provided by the Rust server and do not use the Dart microservice directly. The Rust Karma Coin server provides the verifier api and the blockchain api to clients."),(0,n.kt)("hr",null),(0,n.kt)("admonition",{title:"License",type:"info"},(0,n.kt)("p",{parentName:"admonition"},"Copyright (c) 2022 by the Karma Coin Authors. This work is licensed under the ",(0,n.kt)("a",{parentName:"p",href:"/docs/license"},"Karma Coin License"),".")))}u.isMDXComponent=!0}}]);
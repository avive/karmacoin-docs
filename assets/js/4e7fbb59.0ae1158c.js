"use strict";(self.webpackChunkKarmaCoin=self.webpackChunkKarmaCoin||[]).push([[6092],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),u=r,m=d["".concat(l,".").concat(u)]||d[u]||h[u]||i;return n?a.createElement(m,o(o({ref:t},p),{},{components:n})):a.createElement(m,o({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:r,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},3221:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var a=n(7462),r=(n(7294),n(3905));const i={id:"onboarding",title:"Onboarding",sidebar_label:"Onboarding",slug:"/onboarding"},o=void 0,s={unversionedId:"design/onboarding",id:"version-0.1.0/design/onboarding",title:"Onboarding",description:"On-boarding via a referral",source:"@site/versioned_docs/version-0.1.0/design/onboarding.md",sourceDirName:"design",slug:"/onboarding",permalink:"/docs/onboarding",draft:!1,editUrl:"https://github.com/avive/karmacoin-docs/versioned_docs/version-0.1.0/design/onboarding.md",tags:[],version:"0.1.0",lastUpdatedBy:"avive",lastUpdatedAt:1679332649,formattedLastUpdatedAt:"Mar 20, 2023",frontMatter:{id:"onboarding",title:"Onboarding",sidebar_label:"Onboarding",slug:"/onboarding"},sidebar:"version-0.1.0/someSidebar",previous:{title:"Karma Score",permalink:"/docs/karma-score"},next:{title:"Verifiers",permalink:"/docs/verifiers"}},l={},c=[{value:"On-boarding via a referral",id:"on-boarding-via-a-referral",level:2},{value:"On-boarding without a referral",id:"on-boarding-without-a-referral",level:2}],p={toc:c},d="wrapper";function h(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"on-boarding-via-a-referral"},"On-boarding via a referral"),(0,r.kt)("img",{src:"/appreciate.png",height:"400"}),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Referrer's client creates a ",(0,r.kt)("inlineCode",{parentName:"p"},"payment transaction")," with the receiver's mobile phone number and submits it to the network. In this case the receiver's has not created a user account yet. Referrer can optionally specify a receiver's character trait to appreciate as part of the transaction.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"The transaction gets to the ",(0,r.kt)("inlineCode",{parentName:"p"},"Karmachain transactions pool"),". An active verifier sees the transaction and figures out that receiver hasn't registered yet. It sends a text message to the receiver's mobile phone, with link to download the app to his mobile phone with information about the amount of coin sent, and the optional character trait appreciation. The verifier also stores the id of the pending payment transaction as the ",(0,r.kt)("inlineCode",{parentName:"p"},"referral transaction id")," for the receiver's mobile phone number, so it can be included in the attestation it provides to the user in the next step.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Receiver downloads the Karma Coin mobile app and signs-up using his mobile phone number. This involves verifying his mobile number with the verifier and setting a unique available nickname. The verifier sends a signed attestation about the verified number and its association with an receiver's account id. The attestation includes the referrer's payment transaction id stored in the previous step.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Receiver creates and signs a ",(0,r.kt)("inlineCode",{parentName:"p"},"new user transaction"),". It adds to it the verifier's attestation and the ",(0,r.kt)("inlineCode",{parentName:"p"},"referral transaction id")," obtained by it in step 5 above.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"A block producer gets the ",(0,r.kt)("inlineCode",{parentName:"p"},"new user transaction")," from the pool and processes it. The attestation includes the referrer's payment transaction id. The producer locates this ",(0,r.kt)("inlineCode",{parentName:"p"},"payment transaction")," in the pool by its id, and adds it to the block it is producing. The ",(0,r.kt)("inlineCode",{parentName:"p"},"new user transaction")," is processed first and the ",(0,r.kt)("inlineCode",{parentName:"p"},"payment transaction")," second. As part of processing of the ",(0,r.kt)("inlineCode",{parentName:"p"},"new user transaction"),", the new user's online account is created and the new user's balance is updated with a ",(0,r.kt)("inlineCode",{parentName:"p"},"sign-up reward"),". Next, it updates the referrer's account with the ",(0,r.kt)("inlineCode",{parentName:"p"},"referral reward")," and updates balances based on the ",(0,r.kt)("inlineCode",{parentName:"p"},"payment transaction"),". The referral reward payment is added to the payment translation's ",(0,r.kt)("inlineCode",{parentName:"p"},"transaction event")," emitted by the producer. Note that in case that the ",(0,r.kt)("inlineCode",{parentName:"p"},"payment transaction")," identified by the id is not in the pool, then no referral reward is assigned."))),(0,r.kt)("p",null,"The chain should now have the following state:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Receiver has a new account on chain. "),(0,r.kt)("li",{parentName:"ol"},"Receiver's account is updated with the coin amount sent in the payment transaction from the referrer. "),(0,r.kt)("li",{parentName:"ol"},"A point is added to their character score in the receiver's account if the payment transaction included an appreciation."),(0,r.kt)("li",{parentName:"ol"},"Receiver's account is updated with the sign-up reward when applicable. "),(0,r.kt)("li",{parentName:"ol"},"Referrer's account is updated with the referral reward and is debited the amount sent to the receiver. "),(0,r.kt)("li",{parentName:"ol"},"The transaction fee is debited from referrer's account unless it was paid by the protocol via a subsidy."),(0,r.kt)("li",{parentName:"ol"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"payment transaction")," is on-chain. "),(0,r.kt)("li",{parentName:"ol"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"new user transaction")," is on-chain. "),(0,r.kt)("li",{parentName:"ol"},"Balances are updated with the payment transaction fees. e.g. the fee is either minted by the protocol and assigned to verifier or paid by the referring user to the verifier.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Note that the block producer can only get the ",(0,r.kt)("inlineCode",{parentName:"p"},"payment transaction")," fee (from the referrer or from the protocol) if it adds the 2 transactions to a block it is creating. So it has an incentive to behave according to the protocol.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Referral reward and signup rewards are assigned while the protocol hasn't reached the limit of minting of coins for these rewards. See tokenomics for more info.")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"on-boarding-without-a-referral"},"On-boarding without a referral"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"New user signs-up via a Karma Coin client and verifies his mobile phone number using the active verifier."),(0,r.kt)("li",{parentName:"ol"},"The verifier sends the user a signed attestation with his account number, verified mobile phone number and nickname."),(0,r.kt)("li",{parentName:"ol"},"User queries the verifier for any payment transaction id associated with his mobile phone number. Since there is none, no transaction id is returned."),(0,r.kt)("li",{parentName:"ol"},"The new user creates, signs and submits a ",(0,r.kt)("inlineCode",{parentName:"li"},"new user transaction")," to the Karma Coin blockchain which includes the verifier's attestation. It sets the referral's account id to void to signal that there is no referral for this new account creation."),(0,r.kt)("li",{parentName:"ol"},"A block producer gets the transaction from the memory pool, executes the transaction, adds the new user account and the transaction to the chain and gets the transaction fee from the user or from the protocol if a subsidy is applicable. It also assigns the new user sign-up reward when applicable according to the protocol.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Verifiers are run by the Karma Coin foundation and have an off-chain incentive to pay the transaction fees for new user accounts. e.g. mandate to see Karma Coin grows in terms of unique users.")),(0,r.kt)("p",null,"The chain should now have the following state:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Receiver has a new account on chain."),(0,r.kt)("li",{parentName:"ol"},"Receiver's account is updated with the sign-up reward when applicable."),(0,r.kt)("li",{parentName:"ol"},"The new transaction fee is debited from verifier account unless it was paid by the protocol."),(0,r.kt)("li",{parentName:"ol"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"new user transaction")," is on-chain.")),(0,r.kt)("hr",null),(0,r.kt)("admonition",{title:"License",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Copyright (c) 2022 by the Karma Coin Authors. This work is licensed under the ",(0,r.kt)("a",{parentName:"p",href:"/docs/license"},"Karma Coin License"),".")))}h.isMDXComponent=!0}}]);